<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>搭建生产NFS服务器 | 王者府</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">搭建生产NFS服务器</h1><a id="logo" href="/.">王者府</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">搭建生产NFS服务器</h1><div class="post-meta">Jan 22, 2015</div><div class="post-content"><p>记录Debian 系统生产NFS服务器</p>
<h5 id="一、NFS服务简介"><a href="#一、NFS服务简介" class="headerlink" title="一、NFS服务简介"></a>一、NFS服务简介</h5><p>​    NFS 就是 <strong>N</strong>etwork <strong>F</strong>ile<strong>S</strong>ystem 的缩写，最早之前是由sun 这家公司所发展出来的。 它最大的功能就是可以透过网络，让不同的机器、不同的操作系统、可以彼此分享个别的档案 (share files)。所以，你也可以简单的将他看做是一个文件服务器 (file server) 呢！这个 NFS 服务器可以让你的 PC 来将网络远程的 NFS 服务器分享的目录，挂载到本地端的机器当中， 在本地端的机器看起来，那个远程主机的目录就好像是自己的一个磁盘分区槽一样 (partition)！使用上面相当的便利！</p>
<p>​    简单的来说：它就是是可以透过网络，让不同的主机、不同的操作系统可以共享存储。</p>
<h5 id="二、什么使用NFS"><a href="#二、什么使用NFS" class="headerlink" title="二、什么使用NFS"></a>二、什么使用NFS</h5><p>​    公司生产部门需要对产品设备进行自动化测试，包含PCBA的单板FCT测试、QC测试、入库测试以及整机测试，每个测试环节需要一台测试治具和对于的PC电脑，当前所有的测试程序分布在每个测试PC电脑上，而每次升级测试程序，都需要把所有测试PC电脑进行代码更新，饵这样做的结果是浪费时间且容易遗忘。</p>
<p>​    针对以上问题，综合考虑，选择NFS系统，所有测试代码统一放在生产服务器中，而所有测试PC只需要远程挂载即可。架构如下：</p>
<p><img src="/Users/jinfei/Desktop/屏幕快照 2018-08-27 上午11.00.58.png" alt="屏幕快照 2018-08-27 上午11.00.58"></p>
<h5 id="三、NFS服务器端安装与配置"><a href="#三、NFS服务器端安装与配置" class="headerlink" title="三、NFS服务器端安装与配置"></a>三、NFS服务器端安装与配置</h5><ul>
<li><p>NFS服务端的安装</p>
<p>在Debian下 安装NFS包还是很简单的，在你的termial终端下（su权限）执行以下命令即可</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># apt-get install nfs-common nfs-kernel-server</span><br></pre></td></tr></table></figure>
<ul>
<li>NFS服务器的start与stop</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># /etc/init.d/nfs-kernel-server start  (stop停止， restart重启)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>NFS服务器的配置</p>
<p>首先要创建一个共享目录，以备可以让客户端挂载。例如以下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># mkdir /home/share</span><br><span class="line"># chown nobody.nogroup /home/share</span><br></pre></td></tr></table></figure>
<p>其次，要修改/etc/exports配置文件</p>
<p>打开位置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># emacs /etc/exports</span><br></pre></td></tr></table></figure>
<p>增加如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/share     192.168.3.105(rw,sync) *(ro)</span><br></pre></td></tr></table></figure>
<p>配置说明： 对192.168.3.105赋予读写权限，其他机器仅有只读权限。 </p>
<p>​    这个文件的内容非常简单，每一行由抛出路径，客户名列表以及每个客户名后紧跟的访问选项构成：                                                                              [共享的目录][主机名或IP(参数,参数)</p>
<pre><code>其中参数是可选的，当不指定参数时，nfs将使用默认选项。默认的共享选项是 sync,ro,root_squash,no_delay。 当主机名或IP地址为空时， 则代表共 享给任意客户机提供服务。当将同一目录共享给多个客户机，但对每个客户机提供的权限不同时，可以这样：                                                                 共享的目录][主机名1或IP1(参数1,参数2) [主机名2或IP2(参数3,参数4)]                            
</code></pre><p>下面是一些NFS共享的常用参数：  </p>
<p>ro                      只读访问                                   </p>
<p>rw                      读写访问                                   </p>
<p>sync                    所有数据在请求时写入共享                                   </p>
<p>async                   NFS在写入数据前可以相应请求                     </p>
<p>最后，重启NFS：  #  /etc/init.d/nfs-kernel-server restart</p>
</li>
</ul>
<h5 id="四、NFS客户端安装与配置"><a href="#四、NFS客户端安装与配置" class="headerlink" title="四、NFS客户端安装与配置"></a>四、NFS客户端安装与配置</h5><ul>
<li>NFS客户端的安装</li>
</ul>
<p>执行如下命令可安装nfs客户端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># apt-get install nfs-common</span><br></pre></td></tr></table></figure>
<ul>
<li>查询挂载目录</li>
</ul>
<p>执行如下命令可查询服务器里哪些目录可挂载。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># showmount -e 192.168.3.107（服务器IP）</span><br><span class="line">Export list for 192.168.3.107:</span><br><span class="line"> /home/share (everyone)</span><br></pre></td></tr></table></figure>
<ul>
<li>使用mount命令即可挂载服务器共享目录</li>
</ul>
<p>本地创建一个目录”/data/mynfs”，然后将目录挂载至nfs服务器的指定挂载点即可。挂载命令为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount  192.168.3.105:/home/share /data/mynfs</span><br></pre></td></tr></table></figure>
<p>备注（取消挂载）umount  /data/mynfs</p>
<ul>
<li>设置开机自动挂载</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;/usr/bin/mount -t nfs -onoexec,nosuid,nodev,noatime 192.168.3.107:/home/share /data/mynfs&quot;&gt;&gt; /etc/rc.local</span><br><span class="line"></span><br><span class="line">或者：在/etc/rc.local文件中加入mount 192.168.3.105:/home/share  /data/mynfs</span><br></pre></td></tr></table></figure>
<p>至此NFS服务器搭建好了，并且可以简单使用了，但在实际生产环境里远远不止本文里写的这么简洁，可能会遇到各种奇葩的问题，后面慢慢深入接触吧！</p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Jinfei Wang</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2015/01/22/nfs/">http://up-dream.com/2015/01/22/nfs/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</li></ul></div><br><div class="tags"><a href="/tags/Debian，NFS/">Debian，NFS</a></div><div class="post-nav"><a class="pre" href="/2015/01/25/Berkeley/">嵌入式数据库系统Berkeley DB</a><a class="next" href="/2015/01/21/new/">2015年，新的开始</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://up-dream.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/x2go/" style="font-size: 15px;">x2go</a> <a href="/tags/PM/" style="font-size: 15px;">PM</a> <a href="/tags/VPS/" style="font-size: 15px;">VPS</a> <a href="/tags/ShadowSocks/" style="font-size: 15px;">ShadowSocks</a> <a href="/tags/记录，生活/" style="font-size: 15px;">记录，生活</a> <a href="/tags/记录/" style="font-size: 15px;">记录</a> <a href="/tags/Rust/" style="font-size: 15px;">Rust</a> <a href="/tags/Debian，NFS/" style="font-size: 15px;">Debian，NFS</a> <a href="/tags/PyQtDeploy/" style="font-size: 15px;">PyQtDeploy</a> <a href="/tags/VNC/" style="font-size: 15px;">VNC</a> <a href="/tags/软件/" style="font-size: 15px;">软件</a> <a href="/tags/学习，记录/" style="font-size: 15px;">学习，记录</a> <a href="/tags/工具/" style="font-size: 15px;">工具</a> <a href="/tags/Software/" style="font-size: 15px;">Software</a> <a href="/tags/电影、观后感/" style="font-size: 15px;">电影、观后感</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/读书笔记/" style="font-size: 15px;">读书笔记</a> <a href="/tags/电影/" style="font-size: 15px;">电影</a> <a href="/tags/工作/" style="font-size: 15px;">工作</a> <a href="/tags/笔记/" style="font-size: 15px;">笔记</a> <a href="/tags/产品经理/" style="font-size: 15px;">产品经理</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/09/18/启示录/">启示录 -- 读书笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/02/ShadowSocks/">客户端安装ShadowSocks</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/02/产品经理常去的地方/">产品经理的场子</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/13/学习的苦/">为什么大多数人宁愿吃生活的苦，也不愿意吃学习的哭</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/25/物联网应用层协议/">物联网应用层协议</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/05/第一次主持人/">第一次主持人</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/02/software/">软件资源管理方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/typora/">Typora-极致简洁的markdown编辑器</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/产品经理规划/">产品经理的职业技能</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/10/VPS搭建Shadowsocks服务器/">VPS搭建Shadowsocks服务器</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.fonrich.com" title="丰郅（上海）新能源" target="_blank">丰郅（上海）新能源</a><ul></ul><a href="http://monitoring.fonrich.com:8089" title="Foneye系统" target="_blank">Foneye系统</a><ul></ul><a href="http://www.woshipm.com" title="人人都是产品经理" target="_blank">人人都是产品经理</a><ul></ul><a href="http://www.chanpin100.com" title="产品100" target="_blank">产品100</a><ul></ul><a href="ttps://www.pmcaff.com" title="PMCAFF" target="_blank">PMCAFF</a><ul></ul><a href="http://36kr.com" title="36氪" target="_blank">36氪</a><ul></ul><a href="https://www.huxiu.com" title="虎嗅" target="_blank">虎嗅</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">王者府.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>